"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[3048],{3905:function(e,t,n){n.d(t,{Zo:function(){return h},kt:function(){return m}});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=o.createContext({}),u=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},h=function(e){var t=u(e.components);return o.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},c=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,h=i(e,["components","mdxType","originalType","parentName"]),c=u(n),m=r,d=c["".concat(l,".").concat(m)]||c[m]||p[m]||a;return n?o.createElement(d,s(s({ref:t},h),{},{components:n})):o.createElement(d,s({ref:t},h))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,s=new Array(a);s[0]=c;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var u=2;u<a;u++)s[u]=n[u];return o.createElement.apply(null,s)}return o.createElement.apply(null,n)}c.displayName="MDXCreateElement"},52498:function(e,t,n){n.r(t),n.d(t,{assets:function(){return h},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return i},metadata:function(){return u},toc:function(){return p}});var o=n(83117),r=n(80102),a=(n(67294),n(3905)),s=["components"],i={},l=void 0,u={unversionedId:"tsdz2/How-to-calibrate-the-torque-sensor",id:"tsdz2/How-to-calibrate-the-torque-sensor",title:"How-to-calibrate-the-torque-sensor",description:"\\\\TOC\\\\",source:"@site/docs/tsdz2/How-to-calibrate-the-torque-sensor.md",sourceDirName:"tsdz2",slug:"/tsdz2/How-to-calibrate-the-torque-sensor",permalink:"/docs/tsdz2/How-to-calibrate-the-torque-sensor",draft:!1,editUrl:"https://github.com/OpenSourceEBike/OpenSourceEBike.github.io/tree/master/docs/tsdz2/How-to-calibrate-the-torque-sensor.md",tags:[],version:"current",frontMatter:{},sidebar:"tsdz2Sidebar",previous:{title:"The Difference Between Standard and Advanced Mode",permalink:"/docs/tsdz2/How-to-Calibrate-the-Cadence-Sensor"},next:{title:"How-to-flash-the-Flexible-OpenSource-firmware-on-KT-LCD3",permalink:"/docs/tsdz2/How-to-flash-the-Flexible-OpenSource-firmware-on-KT-LCD3"}},h={},p=[],c={toc:p};function m(e){var t=e.components,n=(0,r.Z)(e,s);return(0,a.kt)("wrapper",(0,o.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"_","_","TOC","_","_"),(0,a.kt)("h1",{id:"why_it_is_important_to_calibrate_the_torque_sensor"},"Why it is important to calibrate the torque sensor?"),(0,a.kt)("p",null,"Almost every torque sensors on TSDZ2 is different and reports different\nvalues for the same weight on the pedals. Some have low sensitivity /\nvery short linear zone only up to 15 kgs while others up to 45 kgs, as\nalso different sensitivity on left and right pedals. As comparison,\nriders like me can do peaks of 40 or 60 kgs on pedals without lift the\nbutt from the saddle.\\\n\\\nWhy this is important? because if you want the best motor response and\nnatural feeling of a bicycle, the torque sensor needs to work/be linear\nthe best possible. Also, this is the only way to trust on the\nmeasurements shown on display for the pedal human power."),(0,a.kt)("p",null,"Here is TSDZ2 1 and TSDZ2 2 the torque sensors measurements - the torque\nsensor of TSDZ2 2 is way better!!, here the comparison:"),(0,a.kt)("p",null,"TSDZ2 1 torque sensor:\n",(0,a.kt)("a",{parentName:"p",href:"https://i.postimg.cc/T2Zg4RFH/Screenshot-from-2019-12-28-10-33-41.png"},"https://i.postimg.cc/T2Zg4RFH/Screenshot-from-2019-12-28-10-33-41.png")),(0,a.kt)("p",null,"TSDZ2 2 torque sensor:\n",(0,a.kt)("a",{parentName:"p",href:"https://i.postimg.cc/jjHXx2gc/Screenshot-from-2019-12-29-19-18-57.png"},"https://i.postimg.cc/jjHXx2gc/Screenshot-from-2019-12-29-19-18-57.png")),(0,a.kt)("p",null,"Notes:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},'One torque sensor is kind of linear only up to 15 kgs while other up\nto 45 kgs. The rate/sensitivity are the same for both on this\n\\"linear\\" zone but clearly mine lacks resolution because this zone\nis very short. I can do peaks of 40 or 60 kgs on my pedals without\ntaking my butt from the saddle.'),(0,a.kt)("li",{parentName:"ol"},"One torque sensor seems to measure the similar values for both left\nand right pedals while the other does not (the left pedal has lower\nsensitivity)."),(0,a.kt)("li",{parentName:"ol"},"The one that is worst on 1. is also worst on 2. So, clearly there\nare torque sensors that are worst than the others.")),(0,a.kt)("p",null,"Explanation of torque sensor calibration done by an user on the forum:\\\n\\\n",(0,a.kt)("em",{parentName:"p"},"The basic idea is that the values the torque sensor reports (raw\nvalues) are different for almost every TSDZ2 out there. To normalize the\nvalues curve, you need to measure the value on the torque sensor for\nvarious known weights. This way the firmware can build a curve and map\ntorque sensor values to actual weight on the pedals.")),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"So you need to have a set of known weights (or use a luggage scale as\nsome have done) and put these weights on the pedals while pressing the\nbrakes so the bike doesn't move and with crank arms parallel to the\nground.")),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"You then write down the torque sensor value and the weight that was on\nit. For both left and right (they have different values).")),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"Once done, enter them in the google docs to have the curve so you can\nsee if you didn't make a mistake (curve should not have drastic spikes\nor you probably made an error in measuring), and you can also use it to\ninterpolate missing weights if you don't have a good range of available\nweights.")),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"You then enter all this in the display configurations menu. The weight\nreported in the firmware after calibration should match the weight in kg\nof whatever is on the pedal with crank arm parallel to the ground at\nthat moment. In my experience it's not ultra accurate but should be\nwithin a kilo or two of the actual weight in kg.")),(0,a.kt)("h1",{id:"how_to_calibrate_your_torque_sensor"},"How to calibrate your torque sensor"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"go to Technical configuration menu to see torque sensor ADC value in\nreal time"),(0,a.kt)("li",{parentName:"ul"},"use weights, your own known weight, weight from other members of\nyour family or friends (mainly others with different value), put\nthem on each pedal only (the pedal crank arms must be parallel to\nthe ground)"),(0,a.kt)("li",{parentName:"ul"},"take note of each weight value and ADC value (for your own weight\nmeasurement, you can lean the bike against a wall, hold the brakes\nand stand on pedal)"),(0,a.kt)("li",{parentName:"ul"},"choose 8 points, first one with 0 weight value and last one with\nyour weight"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.google.com/spreadsheets/d/1OwM1yURzHkPsrL9uz8oNlX6FHGzw_nr2TolGgUH9oy4/edit?usp=sharing%7Cmake"},"a copy of this calc sheet as seen on the next\nimage"),".\nEdit the weight and ADC values on the table and the graph will\nupdate automatically, choose the other 6 points near the knee zone\nas seen on the graph and not on flat zones. You can extrapolate some\npoints if you don\xb4t have the weights, follow the curve on the graph\nbut try to validate with real measurements:")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://i.postimg.cc/T2Zg4RFH/Screenshot-from-2019-12-28-10-33-41.png"},"https://i.postimg.cc/T2Zg4RFH/Screenshot-from-2019-12-28-10-33-41.png"),"\\"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"go to Torque sensor configuration menu and input the data of each\npoint: weight and ADC value")),(0,a.kt)("p",null,"Torque sensor calibration table:\\\n",(0,a.kt)("a",{parentName:"p",href:"https://user-images.githubusercontent.com/147128/71526681-e5fb1480-28cf-11ea-977d-ddf80a2db734.jpg"},"https://user-images.githubusercontent.com/147128/71526681-e5fb1480-28cf-11ea-977d-ddf80a2db734.jpg")),(0,a.kt)("p",null,"Seeing and validating the pedal side as also the weight measured on the\npedals:\\\n",(0,a.kt)("a",{parentName:"p",href:"https://user-images.githubusercontent.com/147128/71526680-e5fb1480-28cf-11ea-854b-c7a2b70390a0.jpg"},"https://user-images.githubusercontent.com/147128/71526680-e5fb1480-28cf-11ea-854b-c7a2b70390a0.jpg")),(0,a.kt)("h1",{id:"how_to_adjust_the_torque_sensor"},"How to adjust the torque sensor"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Warning"),": this is optional and ",(0,a.kt)("strong",{parentName:"p"},"is not advised to do")," since is a\nvery delicate process and risky because it involves disassembling part\nof the TSDZ2 motor and handle the torque sensor. The coils and the wires\nof the torque sensor are fragile and you must handle them with care (you\ncan always buy a spare torque sensor on online shops like PSWPower)."),(0,a.kt)("p",null,"Steps needed:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"disassembly the torque sensor (follow the ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/OpenSource-EBike-firmware/TSDZ2_wiki"},"TSDZ2 Repair Manual.pdf\nfile from\nhere"),")",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"you don\\'t need to remove the motor controller or the motor"),(0,a.kt)("li",{parentName:"ul"},"you will need to remove the main gear, then the axle and finally\nthe torque sensor"),(0,a.kt)("li",{parentName:"ul"},"the coils and the wires of the torque sensor are fragile ","-","-\nmake sure to handle them with care and make sure to ",(0,a.kt)("strong",{parentName:"li"},"disconnect\nthe torque sensor wires from the motor controller otherwise\nthere is a high probability that the wires will break near the\ntorque sensor coil when you remove it!!")),(0,a.kt)("li",{parentName:"ul"},"make sure to not loose the 3 small springs that are under the\ntorque sensor coil"))),(0,a.kt)("li",{parentName:"ul"},"with the torque sensor outside, make sure to hold both coils against\neach other and aligned (maybe using some adhesive tape). Take care\nto not use to much force as the coils are fragile."),(0,a.kt)("li",{parentName:"ul"},"connect the torque sensor wire to the motor controller but make sure\nthe TSDZ2 motor is disabled with the brakes are pressed and motor\nassist at 0"),(0,a.kt)("li",{parentName:"ul"},"turn on TSDZ2 on LCD and go to configuration menu, advanced data,\nand look at torque sensor ADC value"),(0,a.kt)("li",{parentName:"ul"},"you will need to adjust the position of the sensor (that black part)\nand so you will need to loosen the two small screws, as seen on the\nfollowing picture"),(0,a.kt)("li",{parentName:"ul"},"move slightly the sensor (from right to left and keep it far from\nthe little magnets) part until you read an ADC value of 100 up to\n120 (note that a value under 100 means that probably the sensor is\nnot detecting the little magnets, then you need to move it to lefMy\nwife TSDZ2t side)"),(0,a.kt)("li",{parentName:"ul"},"now tighten the screws but you will see that probably the ADC value\nwill change as the position of the sensor will change - you need to\ntighten the screws slowly while keep adjusting the sensor position"),(0,a.kt)("li",{parentName:"ul"},"when the screws are finally tighten, you can test the sensor by\ndoing some light force on the top part, like seen on the picture\nbellow, where I was using a screw driver (but place it on the right\nside and apply light force that will make that metal parts flex very\nlittle to left side). You should see the ADC values increasing and\nalways go the value you calibrated before in the interval of 100 to\n120"),(0,a.kt)("li",{parentName:"ul"},"assemble the torque sensor",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"when assembling the torque sensor, don\\'t forget to install the\n3 small springs under the coil, just like they were when you\ndisassembled."),(0,a.kt)("li",{parentName:"ul"},"maybe you can put your motor on horizontal so the springs are in\nplace when you use the hammer to force the torque sensor to go\nto his place. Please do it in very small steps and make sure the\ncoil, springs, wires, etc are in place. It is easy to damage the\ncoil if it is out of the place."))),(0,a.kt)("li",{parentName:"ul"},"after assembly again the torque sensor on the TSDZ2, finally apply\nforce with your feet on the pedals and verify that ADC torque sensor\nvalues are the same you expect - please refer to the values on table\ntop.")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},'<img src="https://github.com/OpenSource-EBike-firmware/TSDZ2_wiki/blob/master/TSDZ2_torque_Sensor_calibration.jpg" width = 800>'),"{=html}"),(0,a.kt)("p",null,"\\"),(0,a.kt)("h1",{id:"add_on_how_to_repair_a_torque_sensor"},"Add on: How to repair a torque sensor"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"If your Torque Sensor is not working, it could be due to a faulty\nHall Sensor. Here is how I replaced it:"),(0,a.kt)("li",{parentName:"ul"},"Peel off the black stuff to investigate (in my case the Hall Sensor\npins / solder pads were torn off.)",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Be extra careful to not harm any of the tiny SMD parts\nunderneath."))),(0,a.kt)("li",{parentName:"ul"},'The Hall Sensor is a std \\"49E / OH49E / SS49E\\" Hall sensor as\nfound on ebay.'),(0,a.kt)("li",{parentName:"ul"},"Just solder it back on - for details, see linked picture below:")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://user-images.githubusercontent.com/37367314/166138472-73190bc6-7703-4c78-a698-4b12fde4f269.jpg"},"https://user-images.githubusercontent.com/37367314/166138472-73190bc6-7703-4c78-a698-4b12fde4f269.jpg")))}m.isMDXComponent=!0}}]);